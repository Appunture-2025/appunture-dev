% ----------------------------------------------------------
% Capítulo 6 - APRESENTAÇÃO DO SISTEMA
% ----------------------------------------------------------
\chapter{APRESENTAÇÃO DO SISTEMA} \label{cha:apresentacao}

Neste capítulo o \textit{Appunture} é apresentado, pontuando os aspectos técnicos e as funcionalidades que constituem a aplicação.

\section{ARQUITETURA DO SISTEMA} \label{sec:arq_sistema}

O \textit{Appunture} foi desenvolvido seguindo uma arquitetura híbrida e modular que integra funcionalidades \textit{offline} e \textit{online} para garantir alta disponibilidade, desempenho e usabilidade mesmo em ambientes com conexão limitada ou instável. A arquitetura se divide em dois módulos principais: aplicativo móvel (React Native/Expo) e \textit{backend} (Java + Spring Boot).

\subsection{Arquitetura Híbrida (Offline + Online)}

No núcleo do aplicativo móvel, o \textit{Appunture} utiliza um banco de dados local SQLite para armazenar informações do atlas, incluindo os 361 pontos dos meridianos principais, pontos extras, sintomas, relações terapêuticas, favoritos e anotações do usuário. Esta abordagem garante que o aplicativo funcione integralmente em modo \textit{offline}, permitindo consultas rápidas e uso em qualquer lugar, sem depender da conexão com a internet.

Quando a conexão estiver disponível, o sistema realiza sincronizações automáticas e seguras com um \textit{backend} remoto, desenvolvido em Java com Spring Boot, que hospeda o banco de dados Firestore centralizado. Esta sincronização atualiza dados do atlas, envia registros do usuário e mantém o histórico sempre preservado e atualizado.

\subsection{Comunicação e Sincronização}

A comunicação entre o app e o \textit{backend} é realizada via API RESTful, utilizando autenticação Firebase/JWT para controle seguro de acesso. O \textit{backend} disponibiliza \textit{endpoints} públicos para consulta de dados do atlas e \textit{endpoints} privados para operações que envolvem dados do usuário, como sincronização e autenticação.

A sincronização implementa um mecanismo de controle de versões dos dados do atlas para evitar \textit{downloads} desnecessários e garantir que o aplicativo trabalhe sempre com as informações mais recentes. O processo ocorre automaticamente em \textit{background} sempre que uma conexão de internet é detectada.

\subsection{Assistente de IA para Busca Inteligente}

Para viabilizar a busca inteligente por sintomas, o aplicativo utiliza um assistente de inteligência artificial integrado ao \textit{backend}. Esta funcionalidade requer conexão com a internet para processamento.

\textbf{Arquitetura RAG (Retrieval-Augmented Generation):}
O sistema utiliza a arquitetura RAG integrada ao \textit{backend} Java. O assistente inteligente, alimentado pelo Google Gemini 1.5 Flash via Spring AI, interpreta perguntas do usuário sobre sintomas e pontos de acupuntura, fornecendo respostas contextualizadas com a base de dados técnica do sistema. Esta abordagem reduz alucinações do modelo e aumenta a confiabilidade das informações apresentadas.

\textbf{Navegação Offline:}
Quando sem conexão, o usuário pode navegar manualmente pelo atlas anatômico e acessar as informações dos pontos já sincronizados no banco de dados local. A busca inteligente por sintomas fica indisponível até que uma conexão seja restabelecida.

\subsection{Interface Interativa e Navegação}

A interface do app é construída para promover uma experiência intuitiva e visualmente rica, com mapas anatômicos interativos baseados em SVG, que possibilitam a interação direta com os pontos de acupuntura. A navegação é estruturada para facilitar o acesso rápido às principais funcionalidades, como busca, visualização detalhada, favoritos e anotações, promovendo fluidez e usabilidade.

\subsection{Backend e Web Admin}

O \textit{backend} centraliza a gestão dos dados oficiais, incluindo o cadastro e atualização dos pontos, sintomas e suas relações. A gestão do conteúdo é realizada através de APIs REST protegidas, com \textit{endpoints} específicos para operações administrativas que requerem autenticação e permissões adequadas.

\section{AUTENTICAÇÃO E SEGURANÇA} \label{sec:autenticacao}

Para garantir a segurança dos usuários e a integridade dos dados, o sistema implementa autenticação via Firebase Authentication, integrada ao Spring Security no \textit{backend}.

\textbf{Métodos de Autenticação:}
\begin{itemize}
    \item Login com email e senha;
    \item Login social via Google (\textit{Google Sign-In});
    \item Validação de \textit{tokens} JWT (Firebase ID Token) no \textit{backend}.
\end{itemize}

Durante o processo de login, o Firebase Authentication gerencia a validação das credenciais e gera um \textit{token} JWT assinado. Este \textit{token} é utilizado para manter a sessão do usuário e validar o acesso aos recursos protegidos da API.

A sessão é gerenciada pelo aplicativo móvel, que armazena o \textit{token} de forma segura no \textit{storage} local do dispositivo. Desta forma, o usuário permanece logado mesmo após fechar e reabrir o aplicativo. A cada interação que requer comunicação com o \textit{backend}, o \textit{token} é enviado via cabeçalho HTTP para validação e controle de acesso baseado em \textit{roles} (RBAC).

\section{FUNCIONALIDADES DO SISTEMA} \label{sec:funcionalidades}

\subsection{Tela Inicial e Onboarding}

Quando o usuário inicia a utilização do aplicativo pela primeira vez, é apresentada uma sequência de telas de apresentação (\textit{onboarding}) que explicam as principais funcionalidades e benefícios do \textit{Appunture}. Esta experiência introdutória inclui informações sobre o uso \textit{offline}, a busca inteligente e os mapas anatômicos interativos.

Na tela inicial, o usuário pode escolher entre realizar o processo de cadastro ou direcionar-se diretamente para a tela de login. O design foi pensado para transmitir profissionalismo e confiança, utilizando a identidade visual do projeto com cores que remetem à medicina tradicional chinesa e à modernidade tecnológica.

\subsection{Cadastro e Autenticação via Firebase}

O processo de autenticação do \textit{Appunture} é inteiramente gerenciado pelo \textit{Firebase Authentication}, serviço da Google que oferece segurança robusta e escalabilidade. A tela de cadastro foi projetada para ser simples e rápida, solicitando apenas as informações essenciais:

\begin{itemize}
    \item \textbf{Nome completo}: Armazenado no \textit{displayName} do perfil Firebase;
    \item \textbf{Email}: Identificador único do usuário no Firebase;
    \item \textbf{Senha}: Com validação de força mínima (6 caracteres);
    \item \textbf{Confirmação de senha}: Para evitar erros de digitação;
    \item \textbf{Aceite dos termos}: Concordância com os termos de uso e política de privacidade.
\end{itemize}

Ao submeter o formulário, o aplicativo utiliza a função \texttt{createUserWithEmailAndPassword} do Firebase SDK para criar a conta. Em seguida, o \texttt{displayName} é atualizado com o nome informado via \texttt{updateProfile}. Por fim, os dados do usuário são sincronizados com o \textit{backend} Java através de uma chamada à API REST.

O sistema também oferece autenticação via \textit{Google Sign-In}, implementada com o \textit{expo-auth-session}. Neste fluxo, o usuário autoriza o acesso via OAuth 2.0, e o \textit{token} retornado pelo Google é usado para criar uma credencial Firebase via \texttt{GoogleAuthProvider.credential}, completando a autenticação.

Após a autenticação (por qualquer método), o \textit{Firebase ID Token} é obtido e armazenado de forma segura no dispositivo. Este \textit{token} é enviado em todas as requisições ao \textit{backend} para validação e autorização.

Todos os usuários têm acesso igualitário a todas as funcionalidades do atlas educativo, independentemente do método de cadastro utilizado.

\subsection{Tela Principal e Navegação}

A tela principal do aplicativo apresenta as principais funcionalidades de forma organizada e acessível. A navegação é estruturada por abas (\textit{tabs}) na parte inferior da tela, permitindo acesso rápido às seções principais:

\begin{itemize}
    \item \textbf{Início}: Tela inicial com acesso rápido às funcionalidades principais;
    \item \textbf{Buscar}: Sistema de busca por nome de ponto ou código;
    \item \textbf{Sintomas}: Lista de sintomas com pontos relacionados;
    \item \textbf{Meridianos}: Navegação por meridianos com mapas SVG;
    \item \textbf{Assistente}: Chat com IA para consultas contextualizadas;
    \item \textbf{Favoritos}: Lista de pontos favoritados pelo usuário;
    \item \textbf{Perfil}: Configurações do usuário e preferências.
\end{itemize}

\subsection{Mapa Anatômico Interativo}

Uma das funcionalidades mais destacadas do \textit{Appunture} é o mapa anatômico interativo, implementado com tecnologia SVG (\textit{Scalable Vector Graphics}). Este recurso permite que o usuário visualize o corpo humano de forma detalhada e interaja diretamente com os pontos de acupuntura mapeados.

Cada ponto é representado por um marcador visual que, ao ser tocado, exibe informações básicas sobre o ponto em um \textit{tooltip}. O usuário pode então optar por acessar a tela de detalhes completa do ponto selecionado.

O mapa oferece 16 visualizações vetoriais de alta fidelidade, organizadas por meridianos:

\begin{itemize}
    \item 12 meridianos principais: Pulmão (LU), Intestino Grosso (LI), Estômago (ST, ST2), Baço (SP), Coração (HT), Intestino Delgado (SI), Bexiga (BL), Rim (KI), Pericárdio (P), Triplo Aquecedor (TW), Vesícula Biliar (GB) e Fígado (LV);
    \item 2 vasos extraordinários: Vaso Governador (GV/Du Mai) e Vaso Concepção (CV/Ren Mai).
\end{itemize}

Cada mapa SVG é carregado sob demanda, permitindo navegação fluida entre as diferentes visualizações de frente e costas do corpo.

\subsection{Detalhes dos Pontos de Acupuntura}

A tela de detalhes apresenta informações completas sobre cada ponto de acupuntura, organizadas em seções para facilitar a consulta:

\begin{itemize}
    \item \textbf{Identificação}: Nome em português, nome em chinês (pinyin), código internacional;
    \item \textbf{Localização}: Descrição anatômica precisa da localização do ponto;
    \item \textbf{Meridiano}: Identificação do meridiano ao qual o ponto pertence;
    \item \textbf{Profundidade}: Indicação da profundidade de punção recomendada;
    \item \textbf{Indicações}: Lista de condições clínicas para as quais o ponto é indicado;
    \item \textbf{Contraindicações}: Alertas sobre situações em que o ponto não deve ser utilizado;
    \item \textbf{Funções energéticas}: Descrição das funções segundo a MTC;
    \item \textbf{Características especiais}: Pontos de alarme, pontos de assentimento, etc.
\end{itemize}

\subsection{Sistema de Busca Inteligente}

O sistema de busca do \textit{Appunture} utiliza inteligência artificial para oferecer resultados relevantes mesmo quando o usuário não conhece o nome exato do ponto que procura. A busca pode ser realizada por:

\begin{itemize}
    \item Nome do ponto (em português ou pinyin);
    \item Localização anatômica;
    \item Sintomas ou condições clínicas;
    \item Meridiano;
    \item Funções terapêuticas.
\end{itemize}

O assistente de IA interpreta a intenção do usuário e retorna os pontos mais relevantes, mesmo com erros de digitação ou variações na escrita. Esta funcionalidade requer conexão com a internet.

\subsection{Assistente Inteligente com IA Generativa}

O assistente inteligente integrado ao \textit{Appunture} permite que o usuário descreva sintomas em linguagem natural e receba informações educativas sobre pontos de acupuntura. A funcionalidade utiliza a arquitetura RAG (\textit{Retrieval-Augmented Generation}):

\textbf{Funcionamento do Sistema:}
\begin{enumerate}
    \item O sistema intercepta a pergunta do usuário;
    \item Busca contexto relevante na base de dados (pontos e sintomas relacionados);
    \item Envia um \textit{prompt} enriquecido para o modelo Google Gemini 1.5 Flash via Spring AI;
    \item Retorna respostas contextualizadas, baseadas nos dados validados do sistema.
\end{enumerate}

\textbf{Benefícios da Abordagem:}
\begin{itemize}
    \item Respostas contextualizadas com a base de dados técnica;
    \item Redução significativa de alucinações do modelo através da abordagem RAG;
    \item Maior confiabilidade das informações apresentadas;
    \item Rastreabilidade das fontes utilizadas nas respostas.
\end{itemize}

\subsection{Sistema de Favoritos e Anotações Pessoais}

O \textit{Appunture} permite que o usuário salve pontos de acupuntura como favoritos para acesso rápido posterior. Além disso, é possível adicionar anotações pessoais a cada ponto, registrando observações de estudo, experiências ou lembretes.

Estas informações são armazenadas localmente no dispositivo e sincronizadas com o \textit{backend} quando há conexão disponível, garantindo que o usuário não perca seus dados ao trocar de dispositivo.



\section{GESTÃO DE DADOS} \label{sec:admin}

A gestão do conteúdo do \textit{Appunture} é realizada através de APIs REST protegidas no \textit{backend}, com \textit{endpoints} específicos para operações administrativas (prefixo \texttt{/admin/}). As principais funcionalidades disponíveis incluem:

\begin{itemize}
    \item \textit{Endpoints} CRUD para pontos de acupuntura;
    \item Gestão de sintomas e suas relações com pontos;
    \item \textit{Upload} de imagens para o Firebase Storage;
    \item Seed de dados inicial via \texttt{/admin/data/seed};
    \item Controle de acesso baseado em \textit{roles} (RBAC) com Firebase Custom Claims.
\end{itemize}

A documentação completa da API está disponível via Swagger/OpenAPI no \textit{endpoint} \texttt{/swagger-ui.html} do \textit{backend}.
\section{EXPERIÊNCIA DO USUÁRIO E USABILIDADE} \label{sec:ux}

O desenvolvimento da interface do \textit{Appunture} seguiu princípios de design centrado no usuário, priorizando:

\begin{itemize}
    \item \textbf{Simplicidade}: Interface limpa e intuitiva, sem excesso de informações;
    \item \textbf{Consistência}: Padrões visuais e de interação consistentes em todo o aplicativo;
    \item \textbf{Feedback}: Respostas visuais claras para todas as ações do usuário;
    \item \textbf{Acessibilidade}: Suporte a diferentes tamanhos de tela e orientações;
    \item \textbf{Performance}: Carregamento rápido e transições fluidas.
\end{itemize}

\section{PROTÓTIPO DE TELAS} \label{sec:prototipo}

O fluxo de telas do aplicativo foi projetado para proporcionar uma navegação intuitiva entre as diferentes funcionalidades. O usuário pode transitar facilmente entre login, cadastro, tela inicial, busca, detalhes dos pontos, favoritos e anotações, seguindo um fluxo lógico e previsível.

% Aqui podem ser inseridas figuras dos protótipos de tela
% \figura{TELA DE LOGIN}{0.5}{fig/tela-login.png}{Os autores (2025)}{tela-login}{}{}
% \figura{TELA PRINCIPAL}{0.5}{fig/tela-principal.png}{Os autores (2025)}{tela-principal}{}{}
% \figura{MAPA ANATÔMICO}{0.5}{fig/mapa-anatomico.png}{Os autores (2025)}{mapa-anatomico}{}{}
