spring:
  application:
    name: appunture-backend
  profiles:
    active: dev
  ai:
    google:
      ai:
        gemini:
          api-key: ${GOOGLE_AI_API_KEY}
          options:
            model: gemini-1.5-flash
            temperature: 0.3
  # PostgreSQL/JPA removido - usando Firestore
  # datasource:
  #   url: jdbc:postgresql://localhost:5432/appunture
  #   username: appunture
  #   password: password123
  #   driver-class-name: org.postgresql.Driver
  # jpa:
  #   hibernate:
  #     ddl-auto: validate
  #   open-in-view: false
  # flyway:
  #   enabled: true
  #   baseline-on-migrate: true
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

server:
  port: 8080
  servlet:
    context-path: /api
  compression:
    enabled: true
    mime-types: application/json,application/xml,text/html,text/xml,text/plain,application/javascript,text/css
    min-response-size: 1024

logging:
  level:
    root: INFO
    com.appunture.backend: DEBUG

# Configurações Firebase e Google Cloud (para TCC - Plano Gratuito)
firebase:
  project-id: ${FIREBASE_PROJECT_ID:appunture-tcc}
  service-account-key: ${FIREBASE_SERVICE_ACCOUNT_KEY:} # JSON em string base64 ou vazio para usar ADC
  storage:
    bucket: ${FIREBASE_STORAGE_BUCKET:appunture-tcc.appspot.com}

app:
  "file-storage":
    local-path: ./uploads # Fallback se Cloud Storage não estiver disponível
  firebase:
    enabled: ${FIREBASE_ENABLED:true} # Permite desabilitar Firebase para desenvolvimento
  images:
    thumbnail:
      enabled: ${THUMBNAIL_GENERATION_ENABLED:true}
      function-url: ${THUMBNAIL_FUNCTION_URL:}
      fallback-query: alt=media&token=thumb-320&size=320
      default-width: 320
      default-height: 320
  security:
    require-email-verified: false
    cors:
      allowed-origin-patterns:
        - http://localhost:*
        - http://127.0.0.1:*
        - http://192.168.*.*
        - http://10.*.*.*
      allowed-methods:
        - GET
        - POST
        - PUT
        - PATCH
        - DELETE
        - OPTIONS
      allowed-headers:
        - Authorization
        - Content-Type
        - X-Requested-With
        - Accept
      exposed-headers:
        - X-RateLimit-Limit
        - X-RateLimit-Remaining
      allow-credentials: true
      max-age: PT1H
    rate-limit:
      enabled: true
      capacity: 200
      refill-tokens: 200
      refill-duration: PT1M
      strategy: AUTO
      excluded-paths:
        - /api/health/**
        - /v3/api-docs/**
        - /swagger-ui/**
        - /actuator/**

management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus,metrics
  endpoint:
    health:
      probes:
        enabled: true
      show-details: when-authorized
  metrics:
    tags:
      application: ${spring.application.name}
      profile: ${spring.profiles.active}
  prometheus:
    metrics:
      export:
        enabled: true
